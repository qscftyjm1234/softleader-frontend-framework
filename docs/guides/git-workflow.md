[â† è¿”å› README.md](../../README.md)

# Git å·¥ä½œæµèˆ‡å¯¦æˆ°æŒ‡å—

æœ¬æ–‡ä»¶æ—¨åœ¨å”åŠ©åœ˜éšŠæˆå“¡å¿«é€Ÿä¸Šæ‰‹å°ˆæ¡ˆçš„ Git å·¥ä½œæµç¨‹ã€‚åˆ†ç‚ºå…©å¤§éƒ¨åˆ†ï¼š

1.  **å¯¦æˆ°æ•™å­¸**ï¼šé‡å°æ—¥å¸¸é–‹ç™¼æƒ…å¢ƒçš„æ“ä½œæŒ‡å— (æ–°äººå¿…è®€)ã€‚
2.  **é€²éšé…ç½®**ï¼šå°ˆæ¡ˆçš„ Git å·¥å…·è¨­å®šç´°ç¯€èˆ‡åŸç†ã€‚

---

## Part 1: å‹™å¯¦ Git æŒ‡ä»¤èˆ‡æƒ…å¢ƒæ•™å­¸ (å¯¦æˆ°ç¯‡)

æˆ‘å€‘æ¡ç”¨ç°¡åŒ–çš„ Git Flow æµç¨‹ï¼Œæ ¸å¿ƒåŸå‰‡å¦‚ä¸‹ï¼š

1.  **Main åˆ†æ”¯ä¿æŒä¹¾æ·¨**ï¼š`main` éš¨æ™‚è¦æ˜¯å¯éƒ¨ç½²çš„ç‹€æ…‹ï¼Œç¦æ­¢ç›´æ¥ Commitã€‚
2.  **é–‹åˆ†æ”¯é–‹ç™¼**ï¼šæ‰€æœ‰æ–°åŠŸèƒ½æˆ–ä¿®è£œéƒ½åœ¨ç¨ç«‹åˆ†æ”¯é€²è¡Œ (`feature/...` `)ã€‚
3.  **é€é PR åˆä½µ**ï¼šé–‹ç™¼å®Œæˆå¾Œï¼Œç™¼èµ· Pull Request (PR) è«‹æ±‚åˆä½µå› `main`ã€‚
4.  **æ¨™æº–åŒ– Commit**ï¼šä½¿ç”¨ `npm run commit` ä¾†ç”¢ç”Ÿç¬¦åˆè¦ç¯„çš„ Commit è¨Šæ¯ã€‚

### å¸¸ç”¨æƒ…å¢ƒæŒ‡ä»¤ç¸½è¡¨

ä»¥ä¸‹æ•´ç†é–‹ç™¼ä¸­æœ€å¸¸é‡åˆ°çš„æƒ…å¢ƒï¼Œä»¥åŠå°æ‡‰çš„æ¨™æº–æŒ‡ä»¤ã€‚

#### æƒ…å¢ƒ 1ï¼šå‰›æŠŠå°ˆæ¡ˆæŠ“ä¸‹ä¾† / æ¯å¤©æ—©ä¸Šé–‹å·¥

**ç›®æ¨™**ï¼šç¢ºä¿è‡ªå·±çš„ç¨‹å¼ç¢¼æ˜¯æœ€æ–°çš„ï¼Œé¿å…è·Ÿåˆ¥äººè¡çªã€‚

```bash
# 1. åˆ‡æ›å›ä¸»åˆ†æ”¯
git checkout main

# 2. æ‹‰å–é ç«¯æœ€æ–°ç¨‹å¼ç¢¼
git pull origin main
```

#### æƒ…å¢ƒ 2ï¼šé–‹å§‹åšä¸€å€‹æ–°åŠŸèƒ½ (Feature) æˆ–ä¿® Bug (Fix)

**ç›®æ¨™**ï¼šåœ¨ç¨ç«‹çš„ç©ºé–“é–‹ç™¼ï¼Œäº’ä¸å¹²æ“¾ã€‚

```bash
# å‘½åè¦å‰‡ï¼š
# - æ–°åŠŸèƒ½ï¼šfeat/åŠŸèƒ½åç¨± (ä¾‹å¦‚ feat/user-login)
# - ä¿® Bugï¼šfix/å•é¡Œæè¿° (ä¾‹å¦‚ fix/login-error)

# ç¯„ä¾‹ï¼šæ–°å¢ã€Œä½¿ç”¨è€…ç™»å…¥ã€åŠŸèƒ½
git checkout -b feature/user-login
```

#### æƒ…å¢ƒ 3ï¼šå¯«åˆ°ä¸€åŠï¼Œè¦å­˜æª” (Commit)

**ç›®æ¨™**ï¼šå°‡ç›®å‰çš„é€²åº¦ä¿å­˜ä¸‹ä¾†ã€‚
**é‡é»**ï¼šæˆ‘å€‘ä½¿ç”¨ `commitizen` å·¥å…·ä¾†ç¢ºä¿ Commit è¨Šæ¯æ ¼å¼çµ±ä¸€ï¼Œæ–¹ä¾¿æ—¥å¾Œè¿½æŸ¥èˆ‡è‡ªå‹•ç”¢ç”Ÿ Changelogã€‚

```bash
# 1. åŠ å…¥æ‰€æœ‰ä¿®æ”¹çš„æª”æ¡ˆåˆ°æš«å­˜å€
git add .

# 2. å•Ÿå‹•äº’å‹•å¼æäº¤ä»‹é¢ (ğŸ”¥ğŸ”¥ å¼·çƒˆå»ºè­°ä½¿ç”¨é€™å€‹ï¼)
npm run commit

# --- æ¥ä¸‹ä¾†æœƒé€²å…¥äº’å‹•æ¨¡å¼ï¼Œè«‹ä¾åºå›ç­” ---
# ? Select the type of change? (é¸æ“‡é¡å‹)
#   > feat:     æ–°åŠŸèƒ½
#     fix:      ä¿®è£œ Bug
#     docs:     æ–‡ä»¶ä¿®æ”¹
#     style:    æ ¼å¼èª¿æ•´ (ä¸å½±éŸ¿ç¨‹å¼ç¢¼)
#     refactor: é‡æ§‹ç¨‹å¼ç¢¼
#
# ? What is the scope? (é¸å¡«ï¼Œå½±éŸ¿ç¯„åœ)
#   > ä¾‹å¦‚è¼¸å…¥: auth (ä»£è¡¨å½±éŸ¿èªè­‰æ¨¡çµ„)
#
# ? Write a short... description? (å¿…å¡«ï¼Œç°¡çŸ­èªªæ˜)
#   > ä¾‹å¦‚è¼¸å…¥: æ–°å¢ç™»å…¥é é¢èˆ‡è·¯ç”±è¨­å®š
#
# ? Provide a longer description? (é¸å¡«ï¼Œè©³ç´°å…§å®¹)
#   > (é€šå¸¸ç›´æ¥ Enter è·³é)
#
# ? Are there any breaking changes? (æ˜¯å¦æœ‰ç ´å£æ€§æ›´æ–°)
#   > N (é€šå¸¸æ˜¯ No)
# ---------------------------------------------
```

> **Q: ç‚ºä»€éº¼ä¸ç›´æ¥ç”¨ `git commit -m "..."`ï¼Ÿ**
> A: å› ç‚ºæˆ‘å€‘æœ‰è¨­å®š `commitlint` æª¢æŸ¥æ©Ÿåˆ¶ã€‚å¦‚æœä½ æ‰‹æ‰“çš„æ ¼å¼ä¸ç¬¦è¦ç¯„ï¼ˆä¾‹å¦‚ï¼šå¿˜äº†åŠ  typeã€å­—é¦–æ²’å°å¯«ï¼‰ï¼Œæäº¤æœƒè¢«æ“‹ä¸‹ä¾†ã€‚ä½¿ç”¨ `npm run commit` å¯ä»¥å¼•å°ä½ æ­£ç¢ºå¡«å¯«ï¼Œçœå»è¢«æ“‹çš„éº»ç…©ã€‚

#### æƒ…å¢ƒ 4ï¼šæ±è¥¿åšå¥½äº†ï¼Œè¦æ¨ä¸Šå» (Push)

**ç›®æ¨™**ï¼šå°‡ä½ çš„åˆ†æ”¯ä¸Šå‚³åˆ°é ç«¯ä¼ºæœå™¨ (GitHub/GitLab)ï¼Œæº–å‚™ç™¼ PRã€‚

```bash
# ç¬¬ä¸€æ¬¡æ¨é€é€™å€‹åˆ†æ”¯ (è¨­å®šä¸Šæ¸¸)
# -u ä»£è¡¨è¨­å®š upstreamï¼Œä¸‹æ¬¡åœ¨é€™å€‹åˆ†æ”¯ç›´æ¥æ‰“ git push å°±å¥½
git push -u origin feat/user-login
```

#### æƒ…å¢ƒ 5ï¼šé–‹ç™¼å¤ªä¹…ï¼Œè¦æŠŠä¸»åˆ†æ”¯çš„æ›´æ–°åˆé€²ä¾† (Sync)

**ç›®æ¨™**ï¼šå¦‚æœä½ é–‹ç™¼äº†ä¸‰å¤©ï¼Œ`main` å¯èƒ½å·²ç¶“è¢«åˆ¥äººæ›´æ–°äº†ã€‚é€™æ™‚å€™è¦ç”¨ Rebase (è®ŠåŸº) æŠŠåˆ¥äººçš„æ–°æ±è¥¿å¢Šåœ¨ä½ çš„ä¿®æ”¹ä¹‹ä¸‹ï¼Œä¿æŒç·šåœ–ä¹¾æ·¨ã€‚

```bash
# 1. å…ˆåˆ‡å› main æ›´æ–°åˆ°æœ€æ–°
git checkout main
git pull

# 2. åˆ‡å›ä½ çš„åˆ†æ”¯
git checkout feature/user-login

# 3. æŠŠ main çš„é€²åº¦ã€ŒRebaseã€é€²ä¾†
git rebase main

# --- å¦‚æœé‡åˆ°è¡çª (Conflict) ---
# 1. æ‰“é–‹è¡çªæª”æ¡ˆï¼Œæ‰‹å‹•ä¿®æ­£ç¨‹å¼ç¢¼
# 2. åŠ å…¥ä¿®æ­£å¾Œçš„æª”æ¡ˆ: git add .
# 3. ç¹¼çºŒ Rebase:      git rebase --continue
# -----------------------------
```

#### æƒ…å¢ƒ 6ï¼šå¯«åˆ°ä¸€åŠï¼Œè€é—†å«ä½ ä¿®ç·Šæ€¥ Bug (Hotfix)

**ç›®æ¨™**ï¼šç›®å‰å·¥ä½œé‚„æ²’å¥½ï¼Œä¸èƒ½ commitï¼Œä½†ä¹Ÿæ¨ä¸å¾—åˆªæ‰ï¼Ÿç”¨ `stash` (æš«å­˜) å…ˆè—èµ·ä¾†ã€‚

```bash
# 1. æŠŠç›®å‰çš„ä¿®æ”¹å…ˆã€Œè—ã€èµ·ä¾†
git stash

# 2. ç¢ºèªå·¥ä½œå€ä¹¾æ·¨äº†ï¼Œåˆ‡å› main é–‹æ–°åˆ†æ”¯ä¿® Bug
git checkout main
git checkout -b fix/critical-bug
# ... (ä¿®ä¿®ä¿®) ...
# ... (Commit & Push) ...

# 3. Bug ä¿®å®Œå¾Œï¼Œåˆ‡å›ä¾†åŸæœ¬çš„åˆ†æ”¯
git checkout feat/user-login

# 4. æŠŠè—èµ·ä¾†çš„æ±è¥¿ã€Œæ‹¿ã€å‡ºä¾†
git stash pop
```

---

## Part 2: é€²éšé…ç½®èˆ‡è¦ç¯„ (è¨­å®šç¯‡)

ä»¥ä¸‹å…§å®¹ç‚º Git å·¥ä½œæµçš„åº•å±¤é…ç½®èªªæ˜ï¼Œä¸»è¦ä¾›æ¶æ§‹å¸«æˆ–æƒ³æ·±å…¥äº†è§£å·¥å…·åŸç†çš„é–‹ç™¼è€…åƒè€ƒã€‚

### 1. é…ç½®æª”æ¡ˆç¸½è¦½

æ‰€æœ‰ Git ç›¸é—œé…ç½®æª”æ¡ˆä½æ–¼ `configs/git/` ç›®éŒ„:

| æª”æ¡ˆ                                                               | ç”¨é€”                       | ç›¸ä¾å¥—ä»¶          |
| :----------------------------------------------------------------- | :------------------------- | :---------------- |
| [`commit-types.cjs`](../../configs/git/commit-types.cjs)           | Commit é¡å‹å®šç¾© (å–®ä¸€ä¾†æº) | -                 |
| [`commitlint.config.cjs`](../../configs/git/commitlint.config.cjs) | Commit è¨Šæ¯æª¢æŸ¥è¦å‰‡        | `@commitlint/cli` |
| [`cz-config.cjs`](../../configs/git/cz-config.cjs)                 | Commitizen äº’å‹•å¼ä»‹é¢é…ç½®  | `commitizen`      |

#### é…ç½®æ¶æ§‹

å°ˆæ¡ˆæ¡ç”¨ **å…¥å£æª”æ¡ˆ (Root) + å¯¦éš›é…ç½® (Config Dir)** çš„é›™å±¤çµæ§‹ï¼Œä»¥ä¿æŒæ ¹ç›®éŒ„æ•´æ½”ã€‚
ä¾‹å¦‚ `commitlint.config.cjs` å¯¦éš›ä¸Šåªæ˜¯å¼•ç”¨äº† rules ç›®éŒ„ä¸‹çš„è¨­å®šã€‚

### 2. Commit é¡å‹å®šç¾© (commit-types.cjs)

é€™æ˜¯å°ˆæ¡ˆçš„ **å–®ä¸€ä¾†æº**ï¼Œå®šç¾©äº†æ‰€æœ‰å…è¨±çš„ Commit é¡å‹ï¼š

| é¡å‹         | èªªæ˜     | ç¯„ä¾‹                             |
| :----------- | :------- | :------------------------------- |
| **feat**     | æ–°åŠŸèƒ½   | `feat(auth): add login page`     |
| **fix**      | ä¿®è£œ bug | `fix(api): handle timeout error` |
| **docs**     | æ–‡ä»¶ä¿®æ”¹ | `docs: update README`            |
| **style**    | æ ¼å¼èª¿æ•´ | `style: format code`             |
| **refactor** | é‡æ§‹     | `refactor(user): simplify logic` |
| **perf**     | æ•ˆèƒ½æ”¹é€² | `perf(api): cache responses`     |
| **test**     | æ¸¬è©¦ç›¸é—œ | `test(auth): add unit tests`     |
| **chore**    | é›œå‹™     | `chore: update dependencies`     |
| **revert**   | å›é€€ç‰ˆæœ¬ | `revert: undo previous commit`   |

### 3. Commit è¨Šæ¯æª¢æŸ¥ (Commitlint)

æˆ‘å€‘ä½¿ç”¨ `commitlint` å¼·åˆ¶åŸ·è¡Œ Conventional Commits è¦ç¯„ã€‚
é€™æœƒåœ¨åŸ·è¡Œ `git commit` æ™‚ç”± **Husky** è‡ªå‹•è§¸ç™¼ã€‚

**æ ¼å¼è¦å‰‡**ï¼š

```
<type>(<scope>): <subject>
```

- **Type**: å¿…é ˆæ˜¯ä¸Šè¿°åˆ—è¡¨ä¹‹ä¸€ï¼Œå…¨å°å¯«ã€‚
- **Scope**: (é¸å¡«) å½±éŸ¿ç¯„åœï¼Œå…¨å°å¯«ã€‚
- **Subject**: ç°¡çŸ­æè¿°ï¼Œçµå°¾ä¸åŠ å¥è™Ÿã€‚

### 4. ç‰ˆæœ¬ç™¼å¸ƒæµç¨‹ (Standard Version)

å°ˆæ¡ˆé…ç½®äº† `standard-version` ä¾†è‡ªå‹•åŒ–ç‰ˆæœ¬ç®¡ç†ï¼š

```bash
npm run release
```

æ­¤æŒ‡ä»¤æœƒè‡ªå‹•åŸ·è¡Œä»¥ä¸‹å‹•ä½œï¼š

1.  bump `package.json` ç‰ˆæœ¬è™Ÿ
2.  æ ¹æ“š Commit ç´€éŒ„è‡ªå‹•ç”¢ç”Ÿ `CHANGELOG.md`
3.  ç”¢ç”Ÿä¸€å€‹ç‰ˆæœ¬ Tag (ä¾‹å¦‚ `v1.2.0`)
4.  Commit ä¸Šè¿°è®Šæ›´

### 5. ç›¸é—œ NPM å¥—ä»¶

è©³ç´°ä¾è³´åˆ—è¡¨è«‹è¦‹ `package.json` çš„ `devDependencies`ï¼š

- `@commitlint/cli`: æª¢æŸ¥å·¥å…·
- `commitizen`: äº’å‹•å¼ CLI
- `husky`: Git Hooks ç®¡ç† (ä»¥å‰è¦åœ¨ `.git/hooks` å¯« shell scriptï¼Œç¾åœ¨ç”¨ husky è¨­å®š)
- `lint-staged`: åªå°æœ¬æ¬¡ commit çš„æª”æ¡ˆè·‘ eslintï¼ŒåŠ å¿«é€Ÿåº¦
