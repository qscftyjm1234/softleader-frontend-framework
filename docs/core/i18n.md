# 多語系系統 (i18n)

本專案支援多語系功能,讓應用程式能夠根據使用者偏好顯示不同語言的內容。

## 系統架構

### 語言支援

目前支援的語言:

- **繁體中文 (zh-TW)** - 預設語言
- **英文 (en-US)** - 可選語言

### 實作方式

本專案使用 Nuxt 3 的 i18n 模組或自訂的多語系解決方案,透過語言檔案管理翻譯內容。

---

## 語言檔案結構

### 建議的目錄結構

```
locales/
├── zh-TW.json          # 繁體中文
├── en-US.json          # 英文
└── ja-JP.json          # 日文 (可選)
```

### 語言檔案範例

#### zh-TW.json

```json
{
  "common": {
    "submit": "送出",
    "cancel": "取消",
    "confirm": "確認",
    "delete": "刪除",
    "edit": "編輯",
    "save": "儲存",
    "search": "搜尋",
    "loading": "載入中..."
  },
  "auth": {
    "login": "登入",
    "logout": "登出",
    "username": "使用者名稱",
    "password": "密碼",
    "forgotPassword": "忘記密碼?",
    "loginSuccess": "登入成功",
    "loginFailed": "登入失敗,請檢查帳號密碼"
  },
  "user": {
    "profile": "個人資料",
    "settings": "設定",
    "name": "姓名",
    "email": "電子郵件",
    "phone": "電話"
  },
  "validation": {
    "required": "此欄位為必填",
    "email": "請輸入有效的電子郵件",
    "minLength": "至少需要 {min} 個字元",
    "maxLength": "最多 {max} 個字元"
  }
}
```

#### en-US.json

```json
{
  "common": {
    "submit": "Submit",
    "cancel": "Cancel",
    "confirm": "Confirm",
    "delete": "Delete",
    "edit": "Edit",
    "save": "Save",
    "search": "Search",
    "loading": "Loading..."
  },
  "auth": {
    "login": "Login",
    "logout": "Logout",
    "username": "Username",
    "password": "Password",
    "forgotPassword": "Forgot Password?",
    "loginSuccess": "Login successful",
    "loginFailed": "Login failed, please check your credentials"
  },
  "user": {
    "profile": "Profile",
    "settings": "Settings",
    "name": "Name",
    "email": "Email",
    "phone": "Phone"
  },
  "validation": {
    "required": "This field is required",
    "email": "Please enter a valid email",
    "minLength": "Minimum {min} characters required",
    "maxLength": "Maximum {max} characters"
  }
}
```

---

## 使用方式

### 1. 在元件中使用

#### 基本用法

```vue
<script setup lang="ts">
const { t, locale } = useI18n()
</script>

<template>
  <div>
    <h1>{{ t('auth.login') }}</h1>
    <button>{{ t('common.submit') }}</button>
  </div>
</template>
```

#### 帶參數的翻譯

```vue
<script setup lang="ts">
const { t } = useI18n()
</script>

<template>
  <div>
    <!-- 顯示: "至少需要 8 個字元" -->
    <p>{{ t('validation.minLength', { min: 8 }) }}</p>
  </div>
</template>
```

### 2. 切換語言

```vue
<script setup lang="ts">
const { locale, availableLocales } = useI18n()

const changeLanguage = (lang: string) => {
  locale.value = lang
}
</script>

<template>
  <div>
    <select v-model="locale">
      <option
        v-for="lang in availableLocales"
        :key="lang"
        :value="lang"
      >
        {{ lang }}
      </option>
    </select>
  </div>
</template>
```

### 3. 在 Composables 中使用

```typescript
// composables/useAuth.ts
export const useAuth = () => {
  const { t } = useI18n()

  const login = async (credentials: LoginCredentials) => {
    try {
      await $api.auth.login(credentials)
      // 使用翻譯的成功訊息
      showNotification(t('auth.loginSuccess'))
    } catch (error) {
      // 使用翻譯的錯誤訊息
      showNotification(t('auth.loginFailed'), 'error')
    }
  }

  return { login }
}
```

### 4. 在 JavaScript/TypeScript 中使用

```typescript
import { useI18n } from 'vue-i18n'

const { t } = useI18n()

// 動態翻譯
const message = t('common.loading')
console.log(message) // "載入中..."
```

---

## 配置設定

### Nuxt 配置 (nuxt.config.ts)

```typescript
export default defineNuxtConfig({
  modules: ['@nuxtjs/i18n'],

  i18n: {
    locales: [
      { code: 'zh-TW', name: '繁體中文', file: 'zh-TW.json' },
      { code: 'en-US', name: 'English', file: 'en-US.json' }
    ],
    defaultLocale: 'zh-TW',
    lazy: true,
    langDir: 'locales/',
    strategy: 'no_prefix',
    detectBrowserLanguage: {
      useCookie: true,
      cookieKey: 'i18n_locale',
      redirectOn: 'root'
    }
  }
})
```

---

## 最佳實踐

### 1. 使用命名空間組織翻譯

✅ **推薦**: 使用階層式結構

```json
{
  "auth": {
    "login": "登入",
    "logout": "登出"
  },
  "user": {
    "profile": "個人資料"
  }
}
```

❌ **不推薦**: 扁平結構

```json
{
  "authLogin": "登入",
  "authLogout": "登出",
  "userProfile": "個人資料"
}
```

### 2. 使用參數化翻譯

✅ **推薦**: 使用參數

```json
{
  "greeting": "你好, {name}!"
}
```

```vue
<template>
  <p>{{ t('greeting', { name: userName }) }}</p>
</template>
```

❌ **不推薦**: 字串拼接

```vue
<template>
  <p>{{ t('hello') + userName + '!' }}</p>
</template>
```

### 3. 處理複數形式

```json
{
  "items": {
    "count": "沒有項目 | 1 個項目 | {count} 個項目"
  }
}
```

```vue
<template>
  <p>{{ t('items.count', itemCount) }}</p>
</template>
```

### 4. 提供預設值

```typescript
// 當翻譯鍵不存在時,顯示預設值
const text = t('some.missing.key', 'Default Text')
```

---

## 常見場景

### 1. 表單驗證訊息

```typescript
// composables/useValidation.ts
export const useValidation = () => {
  const { t } = useI18n()

  const rules = {
    required: (value: string) => !!value || t('validation.required'),

    email: (value: string) => /.+@.+\..+/.test(value) || t('validation.email'),

    minLength: (min: number) => (value: string) =>
      value.length >= min || t('validation.minLength', { min })
  }

  return { rules }
}
```

### 2. 日期格式化

```typescript
// utils/format/date.ts
export const formatDate = (date: Date, locale: string) => {
  return new Intl.DateTimeFormat(locale, {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  }).format(date)
}
```

```vue
<script setup>
const { locale } = useI18n()
const formattedDate = computed(() => formatDate(new Date(), locale.value))
</script>
```

### 3. 數字格式化

```typescript
// utils/format/number.ts
export const formatCurrency = (amount: number, locale: string) => {
  return new Intl.NumberFormat(locale, {
    style: 'currency',
    currency: locale === 'zh-TW' ? 'TWD' : 'USD'
  }).format(amount)
}
```

---

## 開發工具

### 1. VS Code 擴充套件

推薦安裝:

- **i18n Ally** - 提供翻譯預覽、自動完成、翻譯管理

### 2. 翻譯檢查

```bash
# 檢查缺少的翻譯鍵
npx i18n-check
```

---

## 相關文件

- [開發規範](../guides/development.md)
- [元件系統](./components.md)
- [Nuxt i18n 官方文件](https://i18n.nuxtjs.org/)
